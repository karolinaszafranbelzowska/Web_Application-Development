<!DOCYPE html>
	<!-- Web Application Development - Project, GMIT 2020 -->
	<!-- Karolina Szafran-Belzowska, G00376368@gmit.ie -->
	<!-- Lecturer: dr. Michael Duignan -->

	<!-- Vegetable Sales in Ireland -->
	<!-- Getting Data from cvs file -->
<html lang="en">
<head>
	<meta charset="utf-8">
	<!-- meta element specifies the character encoding used in this element-->
	<meta name="viewport" content="width=device-width, intial-scale=1">
	<!-- set the title of my HTML-->
	<title>The Greenhouse Organics</title>
	<!--Import d3-->
	<script src="https://d3js.org/d3.v5.min.js"></script> 
</head>
<style type = "text/css"> 
	<!--The style attribute specifies an inline style for an element. The attribute is used with the HTML <body> tag, with the CSS property which describes how HTML elements are to be displayed on screen-->
	<!-- I used class selectors (".") and  ID selectors ("#"). The difference between an ID and a class is that an ID can be used to identify one element, whereas a class can be used to identify more than one.-->
	body{ 
		background-color:LightGreen;
		}
	#SignIn{
		background-color:LimeGreen;
		font-family:Tahoma, Segoe UI, Verdana, Helvetica, Sans-Serif;
		height:111px;
		font-size:75%;
		}
	h1{ 
	   font-family:Georgia, Times, serif;
	   color: black;
	   text-align: center;
	   padding: 60px;
	   margin:auto;
	  }
	.d1{
	   background-color:LightGreen;
	   }
	#photo{
		float:left;
         }
	#photo1{
		float:right;
         }
	#info{
        font-family: Georgia, Times, serif;
		font-size:30px;
		color: black;
         }
	#info2{
        font-family: Georgia, Times, serif;
		font-size:30px;
		color: black;
         }
	#info3{
        font-family: Georgia, Times, serif;
		font-size:20px;
		color: black;
		float: center;
        }
	.d2{
        padding: 40px;
        text-align: center;
        background:PaleGreen;
        }
	.d3{
		overflow: hidden;
		float:left;
		}
	.d3 a{
		float:left;
		display:block;
		padding:20px 30px;
		color:black;
		text-decoration:none;
		}
	.d3 a.right{
		float:right;
		}
	.d4{
		margin-top:30px;
		width:300px;
		padding:50px;
		border:2px solid, #CCCCCC;
		border-top-color:rgb(46, 112, 11);
		border-top-style:solid;
		border-top-width:2px;
		
		border-right-color:rgb(46, 112, 11);
		border-right-style:solid;
		border-right-width:2px;
		
		border-bottom-color:rgb(46, 112, 11);
		border-bottom-style:solid;
		border-bottom-width:2px;
		
		border-left-color:rgb(46, 112, 11);
		border-left-style:solid;
		border-left-width:2px;
		
		margin-right: 0px;
		margin-bottom: 0px;
		margin-left: 0px;
		
		display: block;
		margin-inline-start: 2px;
		margin-inline-end: 2px;
		min-inline-size: min-content
		font-size: 96%;
		}
	.container{
		height:auto;
		min-height:20em;
		display:block;
		text-align:left;
		font-size:90%;
	}
	.fieldset label{
		display:block;
		float:left;
		clear:left;
		width:11em;
		padding:0.5em;
			padding-top:0px;
			padding-right:0.5em;
			padding-bottom:0px;
			padding-left:0.5em;
			font-weight:bold;
	}
	.ip{
		1px solid #777;
		border-top-color:rgb(119,119,119);
		border-top-style:solid;
		border-top-width:1px;
		
		border-right-color:rgb(119,119,119);
		border-right-style:solid;
		border-right-width:1px;
		
		border-bottom-color:rgb(119,119,119);
		border-bottom-style:solid;
		border-bottom-width:1px;
		
		border-left-color:rgb(119,119,119);
		border-left-style:solid;
		border-left-width:1px;
		
		width:12em;
	}
	.d5{
		dispaly:block;
		font-size:35px;
		width:auto;
		float:none;
		}
	.login-details{
		text-align:center;
		}
	#login{
		width:50em;
		height:32em;
		padding:50px;
		margin: 0 auto;
		margin-top: 0px;
		margin-right: auto;
		margin-bottom: 0px;
		margin-left: auto;
		text-align:left;
		}
	#sibutton{
		margin-top:0.75em;
		margin-right:0px;
		margin-bottom:0.75em;
		mergin-left:0px;
		tex:left;
		padding:0;
		font-size:1em;
		}
	.fargotten{
		padding-left:8px;
		mrgin-left:5px;
		}
	#gsSignin{
		float:left;	
		}
	#button {
		background-color: LimeGreen;
		border: none;
		color: white;
		width:150px;
		height:60px;
		margin:2px;
		text-align: center;
		text-decoration: none;
		display: inline-block;
		font-size: 16px;
		align-self: center;
		}
	.button1 {
		background-color: PaleGreen;
		border: none;
		color: black;
		width:150px;
		height:60px;
		margin:2px;
		text-align: center;
		text-decoration: none;
		display: inline-block;
		font-size: 20px;
		align-self: center;
		}
	.footer{
		padding: 40px;
		text-align: center;
		background:PaleGreen;
		color: black;
		margin:0;
		}
	#ChartSize{
		background-color: LightGreen;
		color:black;
		font-size: 16px;
		width:150px;
		height:60px;
		text-align: center;
		}
	#ChartColor{
		width: 150px;
		height:60px;
		}
	#myDiv{
		height:550px;
		width: 800px;
		margin-left: auto;
		margin-right: auto;
		margin-top: 10px;
		margin-bottom: 10px;
		}
</style>
<body id="SignIn"> <!-- <body> tag defines the main content of the HTML document -->
		<h1 class="d1">The Grocery Shopping IE</h1>
		<!-- div will define a header and it will be styled with CSS -->
		<div class="d2">
			<img id="photo" src="https://raw.githubusercontent.com/karolinaszafranbelzowska/Web_Application-Development/master/vegetables-png.png", width="500px", height="300px">
			<img id="photo1" src="https://raw.githubusercontent.com/karolinaszafranbelzowska/Web_Application-Development/master/fruits-png.png", width="400px", height="300px">
			<p id="info">We are here for you.</p>
			<p id="info2"> We want the best for you and your family.</p>
			<p id="info3"> You won't pay more for poducts that matter most to you.</p>
		</div>
	
	<div class="d3">
	<!-- The href attribute specifies the URL of the page the link goes to.-->
		<a href="Vegetables.html">Vegetable Boxes</a>
		<a href="Fruits.html">Fruit Boxes</a>
		<a href="AboutUs.html">About Us</a>
		<a href="Shopping.html">Shopping with Us in 2019</a>
		<a href="Sales.html">Sales</a>
		<a href="ContactUs.html">Contact Us</a>
		<a href="SignIn.html" class="right">SignIn</a>
    </div> 
	<div style="background-color: LightGreen; margin: 100px;padding:30px; font-size:20px"> 
	</div>
	
		<p id="main_page">
			
			<!--Divide the main body into a side panel and a main panel-->
			<div class="row">
				<div class="side">
					
					<h3 style="align-self:centre">Compare prices of vegetables and fruits in 2020</h3><br>
					<button class="button1" onclick="Sales('vegetables','vegetables_price')">Vegetables price</button><br>
					<button class="button1" onclick="Sales('fruits', 'fruits_price')">Fruits price</button><br>
					
					<h3>Select Chart Size</h3>
					<select id="ChartSize">
						<option value="400">400px</option>
						<option value="500">500px</option>
						<option value="600">600px</option>
					</select><br>
					
					<h3> Select Chart Color</h3>
					<input type="color" id="ChartColor"><br>
				</div>

				<div class="main">
				<!--Add a product card to display a product, the content of this is variable using the DOM-->
					<h2 style="padding:40;text-align:middle">View a graph of vegetables and fruits prices in 2020</h2><br>
					
					<div id="price_area"></div>
	 
				</div>
			</div>
		</p> 
		
		<div class="footer">
		</div>
		
	</body>
</html>
					

<script>

function Sales(food_label,price_data) {
  
  d3.csv("prices.csv").then(function(data){
      console.log(data);

      data.forEach(function (d) {
        d.Sales = Number(d.Sales); 
      })


      // Variables for chart bar values
      var myHeight = 450;
      var myWidth = Number(document.getElementById("ChartSize").value); 
      var dataCount = data.length;
      var gap = 5;
      var barThickness = ((myWidth / dataCount) - gap);
      var leftOffset = 50 + 0.5 * gap; 
      var chartColour = document.getElementById("ChartColor").value; 
  

      // declaree a scale for X axis; 
      var xScale = d3.scaleBand()
        .domain(data.map(function (d) {
          return d.Month;
        }))
        .range([0, myWidth + (gap * dataCount)]) 


      var yScale = d3.scaleLinear()
        
        .domain([0, d3.max(data, function (d) {
          return d.Sales;
        })])
      
        .range([myHeight, 0]) 
        ; 
		
      var xAxis = d3.axisBottom()
        .scale(xScale);

     
      var yAxis = d3.axisLeft()
        .scale(yScale); 


      var svgContainer = d3.select("#myDiv").append("svg")
        .attr("height", myHeight + 60) 
        .attr("width", (myWidth + 200))
        .attr("transform", "translate(0, 20)"); 


      var myRectangle = svgContainer.selectAll('rect').data(data);

     
      myRectangle.enter().append("rect")

       
        .attr("fill", "yellow")
       
        .attr("x", function (d, i) {
          return leftOffset + 0.5 * gap + (i * (myWidth / dataCount + gap)); 
        }) 
        .attr("y", myHeight)
        .attr("width", barThickness)

        .transition()
        .duration(2000 * speedFactor)
        
        .attr("y", function (d, i) {
          return yScale(d.Sales) 
        })
        
        .attr("height", function (d) {
          return myHeight - yScale(d.Sales);
        })
        .attr("fill", chartColour);


      var mylabel = svgContainer.selectAll('text').data(data);

      mylabel.enter().append("text")

       
        .attr("text-anchor", "middle")
        .attr("font-family", "sans-serif")
        .attr("font-size", "1px")
        .attr("fill", chartColour)
        .attr("x", function (d, i) {
          return (leftOffset + 0.5 * gap + 0.5 * barThickness) + (i * (myWidth / dataCount + gap) - 1); 
        }) 
        .attr("y", 450)

        
        .transition()
        .duration(3000)
        .delay(function (d, i) {
          return 1400 * speedFactor + (0 * 450); 
        })
        .attr("font-size", "16px")
        .ease(d3.easeCubicInOut) 
        // positioning
        .attr("y", function (d) {
          return (d3.max(data, function (d) { return d.Sales; }) * (myHeight / d3.max(data, function (d) { return d.Sales; })) + 20) - d.Sales * (myHeight / d3.max(data, function (d) { return d.Sales; }))  
        })
        // text style
        .attr("fill", "black")
        // text content
        .text(function (d) {
          return d.Sales; // Sales from csv file + unicode degree symbol 
        })

        // transition state one 
        .transition()
        .duration(4000)
        .delay(function (d, i) {
          return 200 + (4000 * speedFactor - (0 * 500));
        })
        .attr("font-size", "10px")
        .attr(d3.easeExpOut); // animation effect


      // --- --- ---
      // LABELS 2 - time periods

      // add label text for Bar Chart, using values from imported file - .data(data)
      //var mylabel = svgContainer.selectAll('text').data(data);

      // enter loops through
      mylabel.enter().append("text")

        // transition state zero (initial)
        .transition()
        .duration(10 * speedFactor)
        .delay(2000)
        // positioning
        .attr("x", function (d, i) {
          return (leftOffset + 0.5 * myWidth / dataCount) + (i * (myWidth / dataCount + gap)); // (50+20) to centre text in the middle of the bar; width of rectangle (40) + 2 for gap between them
        })
        .attr("y", 0.94 * myHeight)
        // text style
        .attr("text-anchor", "middle")
        .attr("font-family", "sans-serif")
        .attr("font-size", "10px")
        .attr("fill", chartColour)
        // text content
        .text(function (d) {
          return d.Year; // time period from csv file
        })

        // transition state two
        .transition()
        .duration(4000 * speedFactor)
        .delay(function (d, i) {
          return 500 * speedFactor + (200 * speedFactor + (i * 100));
        })
        .ease(d3.easeBounceOut) // animation effect
        // Vertical positioning
        .attr("y", function (d) {
          return (d3.max(data, function (d) { return d.Sales; }) * (myHeight / d3.max(data, function (d) { return d.Sales; })) + 30) - d.Sales * (myHeight / d3.max(data, function (d) { return d.Sales; }))  // baseline from top + 20px into the bar, minus (i.e. going up) the height of the rect
        })
        .attr("fill", "#fd7")

        // transition state three
        .transition()
        .duration(2000)
        .delay(2000 + (1000 * 0.5 * speedFactor))
        .attr("fill", chartColour)
        .attr("font-size", "0px")
        .remove()
        .ease(d3.easeLinear); // animation effect


      // --- --- ---
      // AXES rendering

      svgContainer.append("g") // 'g' denotes group
        .attr("transform", "translate(50," + myHeight + ")") // note that height is inside quote marks - it is a text that need to be concatinated!
        .call(xAxis)
        // apply the below to all text elements
        .selectAll("text")
        .attr("transform", "rotate(-60)")
        .attr("text-anchor", "end")
        .attr("x", "-8") // by trial and error
        .attr("y", "8");

      svgContainer.append("g") // 'g' denotes group
        .attr("transform", "translate(" + (leftOffset - 0.5 * gap) + ", 0)")
        .call(yAxis);


    });

} 
</script>